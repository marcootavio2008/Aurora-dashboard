{% extends "base.html" %}

{% block content %}

<h1 class="page-title">âš™ï¸ ConfiguraÃ§Ãµes</h1>

<div class="card">
  <h2>ğŸ‘¤ Adicionar Perfil</h2>

  <div class="row">
    <div class="field">
      <label>Nome exibido</label>
      <input type="text" id="nome" placeholder="Ex: JoÃ£o">
    </div>

  <div class="row">
    <div class="field">
      <label>Senha</label>
      <input type="text" id="senha" placeholder="Ex: 1234">
    </div>

  <div class="row">
    <div class="field">
      <label>PermissÃ£o</label>
      <input type="text" id="role" placeholder="admin ou visitante">
    </div>

<div class="actions">
  <button class="btn-secondary">Cancelar</button>
  <button class="btn-primary" onclick="salvarConfiguracoes()">
    Salvar ConfiguraÃ§Ãµes
  </button>
</div>

<h2>-------------------------------</h2> 


<h2>UsuÃ¡rios cadastrados</h2>
<table id="usersTable">
  <thead>
    <tr>
      <th>UsuÃ¡rio</th>
      <th>Perfil</th>
      <th>AÃ§Ã£o</th>
    </tr>
  </thead>
  <tbody></tbody>
</table>


<script>
async function carregarUsuarios() {
  const res = await fetch("/api/users");
  const users = await res.json();

  const tbody = document.querySelector("#usersTable tbody");
  tbody.innerHTML = "";

  users.forEach(u => {
    const tr = document.createElement("tr");

    tr.innerHTML = `
      <td>${u.username}</td>
      <td>${u.role}</td>
      <td>
        <button onclick="apagarUsuario(${u.id})">ğŸ—‘ Apagar</button>
      </td>
    `;

    tbody.appendChild(tr);
  });
}

async function apagarUsuario(id) {
  if (!confirm("Tem certeza que deseja apagar este usuÃ¡rio?")) return;

  const res = await fetch(`/api/users/${id}`, {
    method: "DELETE"
  });

  if (res.ok) {
    carregarUsuarios();
  } else {
    alert("Erro ao apagar usuÃ¡rio");
  }
}

carregarUsuarios();
</script>

<script src="/static/settings.js"></script>

{% endblock %}
